{{ define "trainer/clients.html" }}

{{ template "layouts/trainer-panel-head.html" .}}

<div id="Clients" class="p-4">
    <h1 class="text-2xl font-bold dark:font-normal mb-2">Clients</h1>
    <hr class="dark:border-slate-700"/>

    <div class="mt-8">
        <button type="button" class="btn">Add</button>
    </div>

    <div class="modal max-w-sm mt-3 p-3 rounded border border-slate-200 dark:border-slate-700">
        <h1 class="text-xl font-bold mb-3">Add Client</h1>
        <label class="block">
            <span class="text-sm text-slate-500 dark:text-slate-400">First Name</span>
            <input type="text" name="firstName" autocomplete="off" class="input" />
        </label>
        <label class="block mt-3">
            <span class="text-sm text-slate-500 dark:text-slate-400">Last Name</span>
            <input type="text" name="lastName" autocomplete="off" class="input" />
        </label> 
        <label class="block mt-3">
            <span class="text-sm text-slate-500 dark:text-slate-400">Email</span>
            <input type="text" name="email" autocomplete="off" class="input" />
        </label> 
        <label class="block mt-3">
            <span class="text-sm text-slate-500 dark:text-slate-400">Phone</span>
            <input type="text" name="phone" autocomplete="off" class="input" />
        </label> 
        <div class="text-right">
            <button type="button"
                class="btn mt-3">
                Save
            </button>
        </div>
    </div>

    <table class="table mt-2">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<script>
    class ClientListManager {
        container = '#Clients';
        elements = {
            table: 'table',
            tbody: 'table tbody'
        }

        constructor(props) {
            ElementHydrator.hydrate(this);

            this.#loadPage();
        }


        async #loadPage() {
            this.#loading = true;
            const reqBody = {};

            const res = await fetch('/trainer/clients/list', {
                headers: {
                    'Authorization': '',
                },
            });

            const body = await res.json();

            // Inject into table
            this.elements.tbody.innerHTML = '';
            for (let client of body.clients) {
                this.elements.tbody.appendChild(this.#buildTableRowFromJson(client));
            }
        }

        #buildTableRowFromJson(json) {
            const row = document.createElement('tr');
            row.innerHTML += `<td>${json.firstName} ${json.lastName}</td>`
            row.innerHTML += `<td>${json.email}</td>`
            row.innerHTML += `<td>${json.phone}</td>`
            return row;
        }

        set #loading(isLoading) {
            if (isLoading) {
                this.elements.tbody.innerHTML = '<tr><td colspan="2" class="text-center"><i class="fa fa-spinner fa-spin mr-2"></i> Loading</td>';
            }
        }
    }
    new ClientListManager();
</script>

{{ template "layouts/trainer-panel-footer.html" .}}

{{ end }}
